{"Description":"SageMaker IAM Role Stack","Parameters":{"ResourceNamePrefix":{"Type":"String","Default":"sagemaker-hyperpod-eks","Description":"Prefix to be used for all resources created by this template."},"S3BucketName":{"Type":"String","Default":"sagemaker-hyperpod-eks-bucket","Description":"The name of the S3 bucket used to store the cluster lifecycle scripts."}},"Resources":{"ExecutionRole":{"Type":"AWS::IAM::Role","Properties":{"AssumeRolePolicyDocument":{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":{"Service":["sagemaker.amazonaws.com"]},"Action":["sts:AssumeRole"]}]},"ManagedPolicyArns":["arn:aws:iam::aws:policy/AmazonSageMakerClusterInstanceRolePolicy","arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy"],"Path":"/","Policies":[{"PolicyDocument":{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Action":["ec2:AssignPrivateIpAddresses","ec2:CreateNetworkInterface","ec2:CreateNetworkInterfacePermission","ec2:DeleteNetworkInterface","ec2:DeleteNetworkInterfacePermission","ec2:DescribeNetworkInterfaces","ec2:DescribeVpcs","ec2:DescribeDhcpOptions","ec2:DescribeSubnets","ec2:DescribeSecurityGroups","ec2:DetachNetworkInterface","ec2:ModifyNetworkInterfaceAttribute","ec2:UnassignPrivateIpAddresses","ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:GetAuthorizationToken","ecr:GetDownloadUrlForLayer","eks-auth:AssumeRoleForPodIdentity","cloudwatch:DescribeAlarms"],"Resource":"*"},{"Effect":"Allow","Action":["ec2:CreateTags"],"Resource":"arn:aws:ec2:*:*:network-interface/*"},{"Effect":"Allow","Action":["s3:ListBucket","s3:GetObject"],"Resource":[{"Fn::Sub":"arn:aws:s3:::${S3BucketName}"},{"Fn::Sub":"arn:aws:s3:::${S3BucketName}/*"}]}]},"PolicyName":{"Fn::Sub":"${ResourceNamePrefix}-ExecutionRolePolicy-${AWS::Region}"}}],"RoleName":{"Fn::Sub":"${ResourceNamePrefix}-SMHP-Exec-Role-${AWS::Region}"}}}},"Outputs":{"SageMakerIAMRoleName":{"Description":"SageMaker IAM role Name","Value":{"Ref":"ExecutionRole"}},"SageMakerIAMRoleArn":{"Description":"SageMaker IAM role Arn","Value":{"Fn::GetAtt":["ExecutionRole","Arn"]}}}}